<!doctype html>
<html lang="ca">
<head>
  <meta charset="utf-8">
  <title>Metacognició - prova</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>
  <h1>Metacognició - prova</h1>

  <label>Nom alumne: <input id="alumne"></label><br>
  <label>Pregunta 1: <input id="p1"></label><br>
  <label>Pregunta 2: <input id="p2"></label><br>
  <label>Objectiu: <input id="obj"></label><br>
  <label>Emoció: <input id="emo"></label><br>
  <label>Altres: <input id="alts"></label><br>
  <button id="send">Enviar</button>

  <p id="status"></p>

  <script>
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwytTKVzZbuf2fLNrJC8eVSBpAlmTuaIA6b2x9S-UMpoguTh8agwRpDLm3y1S9dtiwvLA/exec';
    const API_KEY = 'genetica-4';

    document.getElementById('send').addEventListener('click', async () => {
      const data = {
        _api_key: API_KEY,
        alumne: document.getElementById('alumne').value,
        pregunta1: document.getElementById('p1').value,
        pregunta2: document.getElementById('p2').value,
        objetivo: document.getElementById('obj').value,
        emocio: document.getElementById('emo').value,
        altres: document.getElementById('alts').value
      };

      try {
        const resp = await fetch(WEB_APP_URL, {
          method: 'POST',
          mode: 'cors',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data)
        });
        const j = await resp.json();
        if (j.status === 'ok') {
          document.getElementById('status').textContent = 'Enviat correctament';
        } else {
          document.getElementById('status').textContent = 'Error: ' + (j.message || JSON.stringify(j));
        }
      } catch (err) {
        document.getElementById('status').textContent = 'Error de xarxa: ' + err;
      }
    });
  </script>
</body>
</html>
